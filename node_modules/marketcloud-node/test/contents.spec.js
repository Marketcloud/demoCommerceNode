var marketcloud = require('../index.js'),
	mocha = require('mocha'),
	chai = require('chai');

var expect = chai.expect;

var client = null;
var content_id = null;
describe('Contents',function(){

	before(function(){

		client = new marketcloud.Client({
			public_key: 'c88b04e9-fcd8-42a8-b68e-38413e024c1b',
			secret_key: '2IAt0pF81JNP3868wgQ5Arg98FMKX/bhut4xViGYj8Y='
		})
	});


	it('Should retrieve a list of contents',function(){
		return client.contents.list({})
			.then(function(response){
				
				expect(response.length).to.not.equal(0);
				expect(response.length).to.be.at.most(20);
				console.log("ho trovato questo id ",response[0].id)
				content_id = response[0].id;
			})
	});


	it('Should retrieve a specific content',function(){
		return client.contents.getById(content_id)
			.then(function(response){
				
				expect(response.id).to.equal(content_id);
				
			})
	})

	it('Should create a content',function(){
		var content = {
		  title : "MyTestContent",
		  text : "This is a beautiful content.......",
		  author : {
		    name : "John Doe",
		    image_url : "http://placehold.it/200x200"
		  }
		}
		return client.contents.create(content)
					.then(function(response){
						var content_id = response.id
						
					})

	})

	it('Should update a content',function(){
		var update = {
			price : 19.99,
			stock_level:5
		}
		return client.contents.update(content_id,update)
								.then(function(response){
									
								})
	})


	it('Should delete a content',function(){
		return client.contents.delete(content_id)
								.then(function(response){
									
								})
	})

	
})